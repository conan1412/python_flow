from tqdm import trange
from tqdm import tqdm

def main():
    epoch = 20000
    label = 0
    lr = 0.1
    x = 3

    for i in trange(epoch):
        pre = (x-2) ** 2
        # pre = (x) ** 2
        loss = (pre - label) ** 2
        delta_x = 2 * ((x-2) ** 2) * 2 * (x - 2)
        # delta_x = 2 * (pre - label)
        # delta_x = 2 * ((x) ** 2 - label) * 2 * (x)
        # x += (-delta_x * lr)
        x += -delta_x * lr
    print(x)

    '''
    2000, 0.1, 2.024954188577472
    2000, 0.01, 2.0787359895817272
    2000, 0.001, 2.2424142757680716
    
    20000, 0.1, 2.007903901216992
    20000, 0.01, 2.0249887200722965
    20000, 0.001, 2.0788035743332065
    
    200000, 0.1, 2.0024999324943273
    200000, 0.01, 2.007905303115208
    200000, 0.001, 2.0249918454717024
    
    2000000, 0.1, 2.0007905669389583
    2000000, 0.01, 2.0024999865542674
    2000000, 0.001, 2.0079054327560537
    
    20000000, 0.1, 2.0007905669389583
    20000000, 0.01, 2.0007905689557064
    20000000, 0.001, 2.0024999916257356
    
    '''

if __name__ == '__main__':
    main()